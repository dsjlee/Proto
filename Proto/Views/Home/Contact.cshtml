@{
    ViewBag.Title = "Contact";
}
<h2>@ViewBag.Title.</h2>
<h3>@ViewBag.Message</h3>

<address>
    One Microsoft Way<br />
    Redmond, WA 98052-6399<br />
    <abbr title="Phone">P:</abbr>
    425.555.0100
</address>

<address>
    <strong>Support:</strong>   <a href="mailto:Support@example.com">Support@example.com</a><br />
    <strong>Marketing:</strong> <a href="mailto:Marketing@example.com">Marketing@example.com</a>
</address>
<p>
    <button type="button" id="progress-btn" class="btn btn-primary btn-sm">Progress</button>
</p>
<div class="progress">
    <div class="progress-bar progress-bar-striped"
         id="progress-element"
         role="progressbar" 
         aria-valuenow="0" 
         aria-valuemin="0" 
         aria-valuemax="100" 
         style="width: 0%; min-width: 2em;">0%</div>
</div>

@section Scripts {
<script>
    $(function () {

        $('#progress-btn').click(function () {
            initProgress();
        });
        
        function initProgress() {
            var source = new EventSource('@Url.Action("Progress")');
            var progressEl = $('#progress-element');
            progressEl.addClass('active');

            //source.onopen = function (event) {
            //    progressEl.html('Connection Opened');
            //};
            //source.onerror = function (event) {
                //console.log(source.readyState);
                //if (event.eventPhase == EventSource.CLOSED) {
                //    $('#progress').html('Connection Closed');
                //    source.close();
                //}
            //};
            source.onmessage = function (event) {
                var percent = event.data;
                progressEl.html(percent + '%').css('width', percent + '%').attr('aria-valuenow', percent);
                if (percent == '100') {
                    progressEl.removeClass('active');
                    source.close();
                }
            };
        }
    });
</script>    
}